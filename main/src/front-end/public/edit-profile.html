<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=, initial-scale=1.0" />
    <title>Edit Profile | Fonka</title>
    <link rel="stylesheet" href="./editprofile.css">
  </head>
  <body>
    <nav class="navbar background">
      <ul class="navlist">
      <li class="l1"><a href="/home.html">Home</a></li>

      <li class="l2"><a href="/chats.html">Chats</a></li>
      <li class="l3"><a href="/edit-profile.html">Edit Profile</a></li>
      <li class="l4"><a href="/matching.html">Matching</a></li>
      <li class="l5"><a href="/logout.html">Logout</a></li>
      </ul>
    </nav>

    <header>
      <h1>Edit Your Profile</h1>
    </header>

    <img src="" alt="profile picture" id="profile-picture" />
    <div class="acc-related">
    <form id="edit-form">
    
        <h2>Account Related</h2>
        <div class="Acc-h4>s">
        <h3>Email</h3>
         <input type="email" name="email" required disabled
          >
          <h3>Password</h3>
            <input type="password" name="password" required
          >
        </div>
      </form></div>

  
  <div class="basic-info">
        <h2>Basic Info</h2>

        <div class="first-name">
          
            <h3>First Name</h3>
            <input type="text" name="firstName" value="Abebe" required disabled
          />
        </div>

        <div class="father-name">
          <h3>
            Father Name</h3>
            <input type="text" name="lastName" value="Kebede" required disabled
          />
        </div>
<div class="basic-detail">
        <div>
          <h3>Gender</h3>
         

          <div>
            <label for="">Male</label> 
            <input class="radio"
              type="radio"
              name="sex"
              value="male"
              checked
              required
              disabled
          />

          
            <label for="">Female</label>
            <input class="radio" type="radio" name="sex" value="female" required disabled
          />
        </div>

        <div>
          <h3>Religion</h3>

          
            <label for="">
            <input
              type="radio"
              name="religion"
              value="catholic"
              required
              checked
            /></label><label for="">Catholic
          

          
            <input type="radio" name="religion" value="judaism" required />
            Judaism</label>
          
          <label for="">
            <input type="radio" name="religion" value="muslim" required />
            Muslim</label>
            <input type="radio" name="religion" value="orthodox" required />
            Orthodox
          
        <label for="">
            <input type="radio" name="religion" value="protestant" required />
            Protestant
          </label><label for="">          
            <input type="radio" name="religion" value="other" required />
            Other
          </label>
        </div>

        <div>
          <h3>
            Birthday</h3>
            <input type="date" name="birthday" value="2000-01-01" required
          />
        </div>

        <div class="Bio">
          <h3>
            Bio. Say A few Words About Your Self</h3>
            <input
              type="text"
              name="bio"
              value="The fault in our dreams"
              required
          />
        </div>

        <div>
          <h3>
            Profile Picture</h3>
            <input 
              type="file"
              name="profilePicture"
              accept="image/png, image/jpeg"
            />
          
        </div>
      
</div></div >
    </div>
       
        <div class="Optional">
          <h2 class="opt">Optional</h2>
        <div>
          <h3>religiousPreferences</h3>
            <input
              type="checkbox"
              name="religiousPreferences"
              value="catholic"
            />
            Catholic

        
            <input
              type="checkbox"
              name="religiousPreferences"
              value="judaism"
            />
            Judaism
        
            <input
              type="checkbox"
              name="religiousPreferences"
              value="musliim"
            />
            Muslim
          <br>
            <input
              type="checkbox"
              name="religiousPreferences"
              value="orthodox"
            />
            Orthodox
        
        
            <input
              type="checkbox"
              name="religiousPreferences"
              value="protestant"
            /> 
            Protestant
          
            <input type="checkbox" name="religiousPreferences" value="other" />
            Other
         
        </div>

        <div>
          <h3>
            Your Height (in centimeters)</h3> <input type="number" name="height"
          />
        </div>

        <div>
         

          <div>
            <h3>height range</h3>
            <label>
              Minimum height <input type="number" name="minHeight"
            /></label>
          

          
            <label>
              Maximum height <input type="number" name="maxHeight"
            /></label>
          </div>
        </div>

        <div>
          <h3>Age range</h3><div>
          <label >Minimum Age</label>
          <input type="number" name="minAge" />
          
        

          <label>
            Maximum Age
            <input type="number" name="maxAge" />
          </label></div>
        </div>

        <div>
          <h3>Hobbies</h3>
        
         
         
            <input type="checkbox" name="hobbies" value="movies" />
            <label for="">Movies</label>

          
            <input type="checkbox" name="hobbies" value="picnic-at-mars" />
            <label for="">Picnic at mars</label>
          
       
            <input type="checkbox" name="hobbies" value="the-office" />
           <label for="">The Office</label>
        
            <input type="checkbox" name="hobbies" value="jamaica" />
            <label for="">Jamaica</label>
          
            <input type="checkbox" name="hobbies" value="chicken-cheese" />
            <label for="Chicken cheese"></label>
          
            <input type="checkbox" name="hobbies" value="counting-stars" />
          <label for="">Counting stars</label>
        </div>
        <div>
         <h3>Your educational level</h3>

         
            <input type="radio" name="educationLevel" value="10" required />
           <label for="">Middle</label>

        
            <input type="radio" name="educationLevel" value="20" required />
            <label for="">High school</label>
         
            <input type="radio" name="educationLevel" value="30" required />
            <label for="">University/College</label>
          
            <input type="radio" name="educationLevel" value="40" required />
            <label for="">Masters</label>
          
            <input type="radio" name="educationLevel" value="50" required />
            <label for="">Professor</label>
           
      
            <input
              type="radio"
              name="educationLevel"
              value=""
              required
              checked
            />
            <label for="">None</label>
          
        </div>
        <div>
          <h3>My partner should not be educated below..</h3>

         
            <input
              type="radio"
              name="preferredEducationLevel"
              value="10"
              required
            />
            <label for="">Middle school</label>
            <input
              type="radio"
              name="preferredEducationLevel"
              value="20"
              required
            /> <label for="">High school</label>
         
            <input
              type="radio"
              name="preferredEducationLevel"
              value="30"
              required
            />
            <label for="">University/college</label>
        
            <input
              type="radio"
              name="preferredEducationLevel"
              value="40"
              required
            /> <label for="">Masters</label>
         
            <input
              type="radio"
              name="preferredEducationLevel"
              value="50"
              required
            /> <label for="">Professor</label>
         
            <input
              type="radio"
              name="preferredEducationLevel"
              value=""
              required
              checked
            /> <label for="">I don't mind</label>
          
        </div>

        <div>
          <h3>Location</h3>
          
            <input type="checkbox" name="" id="allow-location-check-box" />
            <label for="">Save my location</label>
          

          <h4>
            <label>
            Good if partner is within</label>
            <input type="number" name="kmRadius" />
            kms
          
        </div></div>
      
      <div class="inner">
      <button class="save">Save</button></div>
    </form>

    <div class="inner">
      <button id="delete-account-btn">Delete Account?</button>
    </div>
  </body>
  <script src="./fill-form.js"></script>
  <script src="./save-location-if-possible.js"></script>

  <script>
    const editForm = document.getElementById("edit-form");
    const profilePicture = document.getElementById("profile-picture");
    const NEXT_URL = "/login.html"; //EDIT THIS IF CHANGED
    const allowLocationCheckBox = document.getElementById(
      "allow-location-check-box"
    );

    fetchAndFill();
    async function fetchAndFill() {
      const url = "/api/profile";

      const response = await fetch(url);
      console.log(response);
      const data = await response.json();
      console.log(data);
      if (response.ok) {
        fillForm(data, editForm);
        profilePicture.setAttribute("src", data.photoUrl);
      }
    }

    editForm.onsubmit = async function (event) {
      event.preventDefault();
      const formData = new FormData(editForm);
      await saveLocationIfPossible(formData, allowLocationCheckBox);

      console.log(...formData);
      const result = await fetch("/api/profile", {
        method: "PUT",
        body: formData,
      });
      const data = await result.json();

      if (result.ok) {
        window.location.reload();
      } else {
        alert("we have met a problem");
      }
      console.log(data);
    };
  </script>

  <script>
    const deleteAccountButton = document.getElementById("delete-account-btn");
    deleteAccountButton.addEventListener("click", handleDeleteAccount);

    async function handleDeleteAccount() {
      const NEXT_URL = "home.html";
      const result = await fetch("/api/", { method: "DELETE" });
      if (result.ok) {
        alert("account deleted");
        window.location = NEXT_URL;
      } else {
        alert("account not deleted");
      }
    }
  </script>
</html>
